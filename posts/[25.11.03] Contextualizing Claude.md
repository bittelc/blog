# Contextualizing Claude

I read a [beautiful blog post](https://worksonmymachine.ai/p/nobody-knows-how-to-build-with-ai) last week by Scott Werner about loading Claude Code up with the correct context on each session start. The blog post is sooo fun because it's one part "this is absurd, how does this work", and one part "it works like this".

I've been experimenting for months now on contextualization processes that give the right amount of awareness to both the general landscape of the current task, as well as the specifics. Tactics like "explore the codebase" were a start but this quickly becomes an insufficient mechanism as the context and complexity of the given task gets larger. Having long back-and-forth conversations about the task was another strategy that I and many have tried. But at some point, the investment outweighs the return.

After reading Scott's blog, I've landed on a system that introduces various layers of abstraction through different markdown files to Claude, and instruct it to read all the different markdown files:

* `CLAUDE.md` – Provide basic info about the repo, but then instruct Claude to read all of the following before doing anything else.
* `pair_programming.md` – What patterns should the user and Claude follow in interactions? What level of detail and explanation?
* `archicture.md` – What are the sacred principles in the repo for building, that should never be forgotten?
* `stories-planning.md` – Where are we at with the project? Broken down into ticket-sized chunks, so context windows can efficiently grasp it.
* `technical-considerations.md` – A stockpile of documentation, lessons learned, RFC-type docs, SDK gotchas, etc.

During my work with both Walt and Legora, I often find myself working on 2 or 3 different tasks at a time; while I wait for my `pulumi up` to complete, in parallel I will start on trying to solve a small bug, or learn about how a Typescript operator works. With this type of workflow, the `stories-planning.md` document would become confusing, with different tasks conflating the same file and confusing the Claude context window.

To solve this, I've applied git worktrees to the workflow. At both Walt and Legora, isolating the `stories-planning.md` file to its own specific worktree directory. These worktree directories live as children within a parent directory which stores the global (not specific to a task) contextualization files. The direcotry structure while I work on Walt's Android app looks like this:

```
/android
  /.claude
    .CLAUDE.md #instructs about all markdown files, and git worktree pattern
    pair_programming.md
    archicture.md
    technical-considerations.md
  /android-main # directory for the `main` git worktree branch
  /android-story-abc # directory for the `abc` git worktree branch
    /.claude
      stories-planning.md # project planning for story "abc"
    [rest of repo]
  /android-story-123 # directory for the `123` git worktree branch
    /.claude
      stories-planning.md # project planning for story "123"
    [rest of repo]
```

At each session boot, Claude is immediately contextualized with the project and the current status.

![Claude Context](../assets/claude-context.png)

You can see the open source code for my setup here in [Walt's Android repo](https://github.com/walt-app/android).
